#if !NETCOREAPP1_1

(Rocky gets farther than I do)
* Update VS2017
* Blow away all code and re-clone

Well, .NET Core is building, but nothing runs. So, for now....

* DONE - Create a Rocks.NETFramework.sln and only put .NET Framework stuff in there. Make sure that builds and all tests pass.
	* Rocks.Shared
	* Rocks.NETFramework
	* Rocks.RockAssemblyTestContainer.Shared
	* Rocks.RockAssemblyTestContainer.NETFramework
	* Rocks.Tests.Types.Shared
	* Rocks.Tests.Types.NETFramework
	* Rocks.Tests.Shared
	* Rocks.Tests.NETFramework
	* Rocks.Run.NETFramework
	* Rocks.Task
	* Rocks.Task.Tests
	* Rocks.Sketchpad
* DONE - Create a Rocks.NETCore.sln and only put .NET Core stuff in there. Make sure that builds (tests won't run though).
	* Rocks.Shared
	* Rocks.NETCore
	* Rocks.RockAssemblyTestContainer.Shared
	* Rocks.RockAssemblyTestContainer.NETCore
	* Rocks.Tests.Types.Shared
	* Rocks.Tests.Types.NETCore
	* Rocks.Tests.Shared
	* Rocks.Tests.NETCore
	* Rocks.Run.NETCore
* DONE - Delete Rocks.Refactor.sln
* DONE - Clear out the Rocks folder
* DONE - Move all the code from Rocks.Refactor to Rocks
* DONE - Git commit
* DONE - ASK FOR HELP on the .NET MVP e-mail :)

Limitations
* .NET Core doesn't support serialization, so you can't serialize mocks there
* You can't load assemblies with the same name in .NET Core, but if you create a new name, then GenerateWhenPublicAndNonPublicMembersExist in .NET Framework fails because the "RockQuarry" InternalsVisibleTo thing doesn't work. So this feature won't work in .NET Core.

TODOs
* I'm throwing .GetTypeInfo() everywhere, should refactor to get it only once per scope
* I have NO tests around IListOfCustomAttributeDataExtensions.GetAttributes() - ugh!
* Why does the .NET Core projects insist on generating the AssemblyInfo attributes?
* Delegate.CreateDelegate is not available in .NET Core. Should revisit to see if there's a workaround.
* ExpressionExtensions - create an extension that generalizes "GetConstructor". Did that, it's called "FindConstructor()". Needs tests :)
* In Validate(), check to see if the type is marked as Obsolete, and if it has, do not allow the mocking process to continue. I believe the compilation process will cack when you try to use an obsolete type.


OK! Now I'm getting farther, here are the compilation errors:

+		[0]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(60,91): error CS0539: 'Rock7df66e96c62240f69a7452f82d9920e9.Handlers' in explicit interface declaration is not a member of interface	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[1]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(68,22): error CS0539: 'Rock7df66e96c62240f69a7452f82d9920e9.Raise(string, EventArgs)' in explicit interface declaration is not a member of interface	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[2]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(15,75): error CS0012: The type 'EventArgs' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[3]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(15,75): error CS0012: The type 'ReadOnlyDictionary<,>' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.ObjectModel, Version=4.0.10.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[4]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(29,35): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[5]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(31,36): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[6]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(34,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[7]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(35,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[8]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(49,44): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[9]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(49,83): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[10]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(49,111): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[11]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(50,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[12]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(51,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[0]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(60,91): error CS0539: 'Rock7df66e96c62240f69a7452f82d9920e9.Handlers' in explicit interface declaration is not a member of interface	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[1]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(68,22): error CS0539: 'Rock7df66e96c62240f69a7452f82d9920e9.Raise(string, EventArgs)' in explicit interface declaration is not a member of interface	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[2]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(15,75): error CS0012: The type 'EventArgs' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[3]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(15,75): error CS0012: The type 'ReadOnlyDictionary<,>' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.ObjectModel, Version=4.0.10.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[4]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(29,35): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[5]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(31,36): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[6]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(34,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[7]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(35,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[8]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(49,44): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[9]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(49,83): error CS0012: The type 'Delegate' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[10]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(49,111): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[11]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(50,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[12]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock7df66e96c62240f69a7452f82d9920e9.cs(51,31): error CS0012: The type 'Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}


There are a couple of lines of code that need to change:

ADD:
using System.Reflection;


var eventDelegate = (S.MulticastDelegate)thisType.GetField(eventName, SR.BindingFlags.Instance | SR.BindingFlags.NonPublic).GetValue(this);
			
			--TO--
			
var eventDelegate = (S.MulticastDelegate)thisType.GetTypeInfo().GetField(eventName, SR.BindingFlags.Instance | SR.BindingFlags.NonPublic).GetValue(this);


handler.Method.Invoke(handler.Target, new object[]{this, args});

			--TO--
			
handler.GetMethodInfo().Invoke(handler.Target, new object[]{this, args});

					
+		[0]	Assembly Path='M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\bin\Debug\netcoreapp1.1\Rocks.Run.NETCore.dll'	Microsoft.CodeAnalysis.MetadataReference {Microsoft.CodeAnalysis.MetadataImageReference}
+		[1]	Assembly Path='C:\Program Files\dotnet\shared\Microsoft.NETCore.App\1.1.1\System.Private.CoreLib.ni.dll'	Microsoft.CodeAnalysis.MetadataReference {Microsoft.CodeAnalysis.MetadataImageReference}
+		[2]	Assembly Path='M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\bin\Debug\netcoreapp1.1\Rocks.NETCore.dll'	Microsoft.CodeAnalysis.MetadataReference {Microsoft.CodeAnalysis.MetadataImageReference}
+		[3]	Assembly Path='C:\Program Files\dotnet\shared\Microsoft.NETCore.App\1.1.1\System.Runtime.dll'	Microsoft.CodeAnalysis.MetadataReference {Microsoft.CodeAnalysis.MetadataImageReference}

					
Down to 2 errors:

+		[0]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock3a9fdcebd74e48c2976d20c5a3587ca9.cs(60,91): error CS0539: 'Rock3a9fdcebd74e48c2976d20c5a3587ca9.Handlers' in explicit interface declaration is not a member of interface	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[1]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock3a9fdcebd74e48c2976d20c5a3587ca9.cs(15,75): error CS0012: The type 'ReadOnlyDictionary<,>' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.ObjectModel, Version=4.0.10.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}

Up to 5?

+		[0]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock1f4c02edc666478d924362dfb8209746.cs(60,13): error CS0433: The type 'ReadOnlyDictionary<TKey, TValue>' exists in both 'System.ObjectModel, Version=4.0.13.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' and 'System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[1]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock1f4c02edc666478d924362dfb8209746.cs(60,91): error CS0539: 'Rock1f4c02edc666478d924362dfb8209746.Handlers' in explicit interface declaration is not a member of interface	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[2]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock1f4c02edc666478d924362dfb8209746.cs(15,75): error CS0535: 'Rock1f4c02edc666478d924362dfb8209746' does not implement interface member 'IMock.Handlers'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[3]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock1f4c02edc666478d924362dfb8209746.cs(17,21): error CS0433: The type 'ReadOnlyDictionary<TKey, TValue>' exists in both 'System.ObjectModel, Version=4.0.13.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' and 'System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[4]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock1f4c02edc666478d924362dfb8209746.cs(18,57): error CS0433: The type 'ReadOnlyDictionary<TKey, TValue>' exists in both 'System.ObjectModel, Version=4.0.13.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' and 'System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}


+		[0]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock33764474ddaf4edc9842027396b9ec32.cs(60,13): error CS0433: The type 'ReadOnlyDictionary<TKey, TValue>' exists in both 'System.ObjectModel, Version=4.0.13.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' and 'System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[1]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock33764474ddaf4edc9842027396b9ec32.cs(60,91): error CS0539: 'Rock33764474ddaf4edc9842027396b9ec32.Handlers' in explicit interface declaration is not a member of interface	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[2]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock33764474ddaf4edc9842027396b9ec32.cs(15,75): error CS0535: 'Rock33764474ddaf4edc9842027396b9ec32' does not implement interface member 'IMock.Handlers'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[3]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock33764474ddaf4edc9842027396b9ec32.cs(17,21): error CS0433: The type 'ReadOnlyDictionary<TKey, TValue>' exists in both 'System.ObjectModel, Version=4.0.13.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' and 'System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}
+		[4]	M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Run.NETCore\Rock33764474ddaf4edc9842027396b9ec32.cs(18,57): error CS0433: The type 'ReadOnlyDictionary<TKey, TValue>' exists in both 'System.ObjectModel, Version=4.0.13.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' and 'System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'	Microsoft.CodeAnalysis.Diagnostic {Microsoft.CodeAnalysis.CSharp.CSDiagnostic}


Finally down to 1 warning:

warning CS1702: Assuming assembly reference 'System.ObjectModel, Version=4.0.10.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' used by 'Rocks.NETCore' matches identity 'System.ObjectModel, Version=4.0.13.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' of 'System.ObjectModel', you may need to supply runtime policy

Build works and runs, now on to tests. Getting around 300 errors, here are some of the failures:

FIXED
* Rocks.Tests.CachingTests.CreateTwoMocksWithCaching
<message><![CDATA[System.NullReferenceException : Object reference not set to an instance of an object.]]></message>
              <stack-trace><![CDATA[   at Rocks.Extensions.ExpressionExtensions.Create(Expression this, Type expectationType, ParameterInfo parameter) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Extensions\ExpressionExtensions.cs:line 42
   at Rocks.Extensions.MethodCallExpressionExtensions.GetArgumentExpectations(MethodCallExpression this) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Extensions\MethodCallExpressionExtensions.cs:line 22
   at Rocks.RockCore`1.Handle(Expression`1 expression) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockCore.cs:line 61
   at Rocks.Tests.CachingTests.CreateTwoMocksWithCaching() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\CachingTests.cs:line 13]]></stack-trace>
   
* Rocks.Tests.ClassTests.Make
              <message><![CDATA[System.IO.FileLoadException : Assembly with same name is already loaded]]></message>
              <stack-trace><![CDATA[   at System.Runtime.Loader.AssemblyLoadContext.LoadFromStream(IntPtr ptrNativeAssemblyLoadContext, IntPtr ptrAssemblyArray, Int32 iAssemblyArrayLen, IntPtr ptrSymbols, Int32 iSymbolArrayLen, ObjectHandleOnStack retAssembly)
   at System.Runtime.Loader.AssemblyLoadContext.LoadFromStream(Stream assembly, Stream assemblySymbols)
   at Rocks.Construction.InMemory.InMemoryCompiler.ProcessStreams(MemoryStream assemblyStream, MemoryStream pdbStream) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\InMemory\InMemoryCompiler.cs:line 38
   at Rocks.Construction.Compiler`1.Compile() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\Compiler.cs:line 117
   at Rocks.Construction.InMemory.InMemoryMaker..ctor(Type baseType, ReadOnlyDictionary`2 handlers, SortedSet`1 namespaces, RockOptions options, Boolean isMake) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\InMemory\InMemoryMaker.cs:line 23
   at Rocks.InMemoryRock`1.GetMockType(ReadOnlyDictionary`2 readOnlyHandlers) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\InMemoryRock.cs:line 65
   at Rocks.InMemoryRock`1.Make() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\InMemoryRock.cs:line 27
   at Rocks.Tests.ClassTests.Make() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\ClassTests.cs:line 20]]></stack-trace>

* Rocks.Tests.ExpectationsTests.HandleWithCall
              <message><![CDATA[System.NullReferenceException : Object reference not set to an instance of an object.]]></message>
              <stack-trace><![CDATA[   at Rocks.Extensions.ExpressionExtensions.Create(Expression this, Type expectationType, ParameterInfo parameter) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Extensions\ExpressionExtensions.cs:line 81
   at Rocks.Extensions.MethodCallExpressionExtensions.GetArgumentExpectations(MethodCallExpression this) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Extensions\MethodCallExpressionExtensions.cs:line 22
   at Rocks.RockCore`1.Handle(Expression`1 expression) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockCore.cs:line 61
   at Rocks.Tests.ExpectationsTests.HandleWithCall() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\ExpectationsTests.cs:line 63]]></stack-trace>

   
"M:\\JasonBock\\Personal\\Code Projects\\Rocks\\Rocks.Tests.NETCore\\bin\\Debug\\netcoreapp1.1\\Rocks.Tests.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.codeanalysis.common\\2.0.0\\lib\\netstandard1.3\\Microsoft.CodeAnalysis.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.codeanalysis.csharp.workspaces\\2.0.0\\lib\\netstandard1.3\\Microsoft.CodeAnalysis.CSharp.Workspaces.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.codeanalysis.csharp\\2.0.0\\lib\\netstandard1.3\\Microsoft.CodeAnalysis.CSharp.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.codeanalysis.visualbasic.workspaces\\2.0.0\\lib\\netstandard1.3\\Microsoft.CodeAnalysis.VisualBasic.Workspaces.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.codeanalysis.visualbasic\\2.0.0\\lib\\netstandard1.3\\Microsoft.CodeAnalysis.VisualBasic.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.codeanalysis.workspaces.common\\2.0.0\\lib\\netstandard1.3\\Microsoft.CodeAnalysis.Workspaces.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.composition\\1.0.27\\lib\\portable-net45+win8+wp8+wpa81\\System.Composition.AttributedModel.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.composition\\1.0.27\\lib\\portable-net45+win8+wp8+wpa81\\System.Composition.Convention.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.composition\\1.0.27\\lib\\portable-net45+win8+wp8+wpa81\\System.Composition.Hosting.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.composition\\1.0.27\\lib\\portable-net45+win8+wp8+wpa81\\System.Composition.Runtime.dll;C:\\Users\\jasonb\\.nuget\\packages\\microsoft.composition\\1.0.27\\lib\\portable-net45+win8+wp8+wpa81\\System.Composition.TypedParts.dll;C:\\Users\\jasonb\\.nuget\\packages\\nunit\\3.6.1\\lib\\netstandard1.6\\nunit.framework.dll;C:\\Users\\jasonb\\.nuget\\packages\\nunitlite\\3.6.1\\lib\\netstandard1.6\\nunitlite.dll;M:\\JasonBock\\Personal\\Code Projects\\Rocks\\Rocks.Tests.NETCore\\bin\\Debug\\netcoreapp1.1\\Rocks.NETCore.dll;M:\\JasonBock\\Personal\\Code Projects\\Rocks\\Rocks.Tests.NETCore\\bin\\Debug\\netcoreapp1.1\\Rocks.RockAssemblyTestContainer.dll;M:\\JasonBock\\Personal\\Code Projects\\Rocks\\Rocks.Tests.NETCore\\bin\\Debug\\netcoreapp1.1\\Rocks.Tests.Types.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.collections.immutable\\1.3.1\\lib\\netstandard1.0\\System.Collections.Immutable.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.diagnostics.contracts\\4.3.0\\lib\\netstandard1.0\\System.Diagnostics.Contracts.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.diagnostics.fileversioninfo\\4.3.0\\runtimes\\win\\lib\\netstandard1.3\\System.Diagnostics.FileVersionInfo.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.diagnostics.stacktrace\\4.3.0\\lib\\netstandard1.3\\System.Diagnostics.StackTrace.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.reflection.metadata\\1.4.2\\lib\\netstandard1.1\\System.Reflection.Metadata.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.text.encoding.codepages\\4.3.0\\runtimes\\win\\lib\\netstandard1.3\\System.Text.Encoding.CodePages.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.valuetuple\\4.3.0\\lib\\netstandard1.0\\System.ValueTuple.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.xml.xmldocument\\4.3.0\\lib\\netstandard1.3\\System.Xml.XmlDocument.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.xml.xpath.xdocument\\4.3.0\\lib\\netstandard1.3\\System.Xml.XPath.XDocument.dll;C:\\Users\\jasonb\\.nuget\\packages\\system.xml.xpath\\4.3.0\\lib\\netstandard1.3\\System.Xml.XPath.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\Microsoft.CSharp.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\Microsoft.VisualBasic.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\Microsoft.Win32.Registry.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.AppContext.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Buffers.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Collections.Concurrent.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.ComponentModel.Annotations.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.ComponentModel.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Diagnostics.DiagnosticSource.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Diagnostics.Process.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Dynamic.Runtime.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Globalization.Extensions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.Compression.ZipFile.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.Compression.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.FileSystem.Primitives.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.FileSystem.Watcher.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.MemoryMappedFiles.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.UnmanagedMemoryStream.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Linq.Expressions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Linq.Parallel.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Linq.Queryable.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Linq.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Net.Http.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Net.NameResolution.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Net.Requests.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Net.Security.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Net.WebHeaderCollection.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Numerics.Vectors.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.ObjectModel.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.DispatchProxy.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.Emit.ILGeneration.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.Emit.Lightweight.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.Emit.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.TypeExtensions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Resources.Reader.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Runtime.InteropServices.RuntimeInformation.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Runtime.Loader.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Runtime.Numerics.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Claims.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Cryptography.Algorithms.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Cryptography.Cng.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Cryptography.Csp.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Cryptography.Encoding.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Cryptography.OpenSsl.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Cryptography.Primitives.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Cryptography.X509Certificates.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Principal.Windows.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Security.Principal.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Text.RegularExpressions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.Overlapped.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.Tasks.Dataflow.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.Tasks.Extensions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.Tasks.Parallel.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.Thread.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.ThreadPool.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Xml.ReaderWriter.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Xml.XDocument.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Collections.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Diagnostics.Tools.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Diagnostics.Tracing.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Globalization.Calendars.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Globalization.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.Extensions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.Primitives.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Reflection.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Resources.ResourceManager.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Runtime.Handles.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Runtime.InteropServices.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Runtime.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Text.Encoding.Extensions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Text.Encoding.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.Tasks.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Threading.Timer.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\Microsoft.Win32.Primitives.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Console.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Diagnostics.Debug.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.IO.FileSystem.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Net.Primitives.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Net.Sockets.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Runtime.Extensions.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\SOS.NETCore.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Private.CoreLib.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\mscorlib.dll;C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\1.1.1\\System.Private.Uri.dll"

Rocks.Tests.CachingTests.CreateTwoMocksWithCaching
<message><![CDATA[System.IO.FileLoadException : Assembly with same name is already loaded]]></message>
              <stack-trace><![CDATA[   at System.Runtime.Loader.AssemblyLoadContext.LoadFromStream(IntPtr ptrNativeAssemblyLoadContext, IntPtr ptrAssemblyArray, Int32 iAssemblyArrayLen, IntPtr ptrSymbols, Int32 iSymbolArrayLen, ObjectHandleOnStack retAssembly)
   at System.Runtime.Loader.AssemblyLoadContext.LoadFromStream(Stream assembly, Stream assemblySymbols)
   at Rocks.Construction.InMemory.InMemoryCompiler.ProcessStreams(MemoryStream assemblyStream, MemoryStream pdbStream) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\InMemory\InMemoryCompiler.cs:line 38
   at Rocks.Construction.Compiler`1.Compile() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\Compiler.cs:line 136
   at Rocks.Construction.InMemory.InMemoryMaker..ctor(Type baseType, ReadOnlyDictionary`2 handlers, SortedSet`1 namespaces, RockOptions options, Boolean isMake) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\InMemory\InMemoryMaker.cs:line 23
   at Rocks.InMemoryRock`1.GetMockType(ReadOnlyDictionary`2 readOnlyHandlers) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\InMemoryRock.cs:line 65
   at Rocks.InMemoryRock`1.Make() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\InMemoryRock.cs:line 27
   at Rocks.Tests.CachingTests.CreateTwoMocksWithCaching() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\CachingTests.cs:line 15]]></stack-trace>
   
   
Message: Rocks.Exceptions.ValidationException : The type NonPublicAndPublicMembers has internal abstract member(s) without an appropriate InternalsVisibleToAttribute to allow the mock to override the member(s).

OK, we have tension here....
.NET Framework has this: [assembly: InternalsVisibleTo("RockQuarry")]
But in .NET Core I changed the name to add a Guid because it was complaining that an assembly with the same name already exists.
But if I DON'T change the name, then I get the error.


Now getting about 580 tests to succeed
FIXED:
          <test-case id="1036" name="MakeWithCustomConstructor" fullname="Rocks.Tests.ClassTests.MakeWithCustomConstructor" methodname="MakeWithCustomConstructor" classname="Rocks.Tests.ClassTests" runstate="Runnable" seed="1394636412" result="Failed" label="Error" start-time="2017-04-07 23:50:53Z" end-time="2017-04-07 23:50:53Z" duration="0.246089" asserts="0">
            <failure>
              <message><![CDATA[System.MissingMethodException : Constructor on type 'Rocks.Tests.Rock7b857d327e2b435a96c1c3bab22482a0' not found.]]></message>
              <stack-trace><![CDATA[   at System.RuntimeType.CreateInstanceImpl(BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfo culture, Object[] activationAttributes, StackCrawlMark& stackMark)
   at System.Activator.CreateInstance(Type type, BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfo culture, Object[] activationAttributes)
   at System.Activator.CreateInstance(Type type, Object[] args)
   at Rocks.InMemoryRock`1.Make(Object[] constructorArguments) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\InMemoryRock.cs:line 42
   at Rocks.Tests.ClassTests.MakeWithCustomConstructor() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\ClassTests.cs:line 32]]></stack-trace>
            </failure>
          </test-case>
		  
          <test-case id="1277" name="MakeWithGetAndSetIndexerProperty" fullname="Rocks.Tests.HandleProperty1IndexerTests.MakeWithGetAndSetIndexerProperty" methodname="MakeWithGetAndSetIndexerProperty" classname="Rocks.Tests.HandleProperty1IndexerTests" runstate="Runnable" seed="889040366" result="Failed" label="Error" start-time="2017-04-08 00:14:01Z" end-time="2017-04-08 00:14:01Z" duration="0.055253" asserts="0">
            <failure>
              <message><![CDATA[System.NullReferenceException : Object reference not set to an instance of an object.]]></message>
              <stack-trace><![CDATA[   at Rocks.Extensions.PropertyInfoExtensions.GetGetterHandler(PropertyInfo this, ReadOnlyCollection`1 indexers, Delegate handler) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Extensions\PropertyInfoExtensions.cs:line 175
   at Rocks.RockCore`1.Handle[T1,TPropertyValue](Expression`1 indexer1, Func`2 getter, Action`2 setter) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockCore.cs:line 1137
   at Rocks.Tests.HandleProperty1IndexerTests.MakeWithGetAndSetIndexerProperty() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\HandleProperty1IndexerTests.cs:line 156]]></stack-trace>
            </failure>
          </test-case>

Down to 8 errors:
          <test-case id="1435" name="HandleMultiple" fullname="Rocks.Tests.MultipleExpectationsTests.HandleMultiple" methodname="HandleMultiple" classname="Rocks.Tests.MultipleExpectationsTests" runstate="Runnable" seed="19303942" result="Failed" label="Error" start-time="2017-04-08 01:23:31Z" end-time="2017-04-08 01:23:31Z" duration="0.071546" asserts="0">
            <failure>
              <message><![CDATA[System.InvalidOperationException : Sequence contains no matching element]]></message>
              <stack-trace><![CDATA[   at System.Linq.Enumerable.Single[TSource](IEnumerable`1 source, Func`2 predicate)
   at Rocks.Extensions.ExpressionExtensions.Create(Expression this, Type expectationType, ParameterInfo parameter) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Extensions\ExpressionExtensions.cs:line 28
   at Rocks.Extensions.MethodCallExpressionExtensions.GetArgumentExpectations(MethodCallExpression this) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Extensions\MethodCallExpressionExtensions.cs:line 22
   at Rocks.RockCore`1.Handle(Expression`1 expression) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockCore.cs:line 61
   at Rocks.Tests.MultipleExpectationsTests.HandleMultiple() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\MultipleExpectationsTests.cs:line 14]]></stack-trace>
            </failure>
          </test-case>
		  
          <test-case id="1442" name="GenerateWhenPublicAndNonPublicMembersExist" fullname="Rocks.Tests.NonPublicTests.GenerateWhenPublicAndNonPublicMembersExist" methodname="GenerateWhenPublicAndNonPublicMembersExist" classname="Rocks.Tests.NonPublicTests" runstate="Runnable" seed="129315257" result="Failed" label="Error" start-time="2017-04-08 01:23:31Z" end-time="2017-04-08 01:23:31Z" duration="0.002309" asserts="0">
            <failure>
              <message><![CDATA[Rocks.Exceptions.ValidationException : The type NonPublicAndPublicMembers has internal abstract member(s) without an appropriate InternalsVisibleToAttribute to allow the mock to override the member(s).]]></message>
              <stack-trace><![CDATA[   at Rocks.Rock.Create[T](RockOptions options) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Rock.cs:line 40
   at Rocks.Rock.Create[T]() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Rock.cs:line 18
   at Rocks.Tests.NonPublicTests.GenerateWhenPublicAndNonPublicMembersExist() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\NonPublicTests.cs:line 12]]></stack-trace>
            </failure>
          </test-case>

          <test-case id="1473" name="GenerateForAssemblyThatContainsObject" fullname="Rocks.Tests.RockAssemblyTests.GenerateForAssemblyThatContainsObject" methodname="GenerateForAssemblyThatContainsObject" classname="Rocks.Tests.RockAssemblyTests" runstate="Runnable" seed="961604888" result="Failed" label="Error" start-time="2017-04-08 01:23:32Z" end-time="2017-04-08 01:23:39Z" duration="6.611092" asserts="0">
            <failure>
              <message><![CDATA[Rocks.Exceptions.CompilationException : Exception of type 'Rocks.Exceptions.CompilationException' was thrown.]]></message>
              <stack-trace><![CDATA[   at Rocks.Construction.Compiler`1.Compile() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\Compiler.cs:line 136
   at Rocks.RockAssembly.Generate() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockAssembly.cs:line 65
   at Rocks.RockAssembly..ctor(Assembly assembly, RockOptions options) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockAssembly.cs:line 31
   at Rocks.Tests.RockAssemblyTests.GenerateForAssemblyThatContainsObject() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\RockAssemblyTests.cs:line 80]]></stack-trace>
            </failure>
          </test-case>
		  
4 failures left:
This one I can't do anything about. It's the assembly name issue in .NET Core. Will not run this in .NET Core to resolve
          <test-case id="1442" name="GenerateWhenPublicAndNonPublicMembersExist" fullname="Rocks.Tests.NonPublicTests.GenerateWhenPublicAndNonPublicMembersExist" methodname="GenerateWhenPublicAndNonPublicMembersExist" classname="Rocks.Tests.NonPublicTests" runstate="Runnable" seed="1318114354" result="Failed" label="Error" start-time="2017-04-08 03:54:42Z" end-time="2017-04-08 03:54:42Z" duration="0.057540" asserts="0">
            <failure>
              <message><![CDATA[Rocks.Exceptions.ValidationException : The type NonPublicAndPublicMembers has internal abstract member(s) without an appropriate InternalsVisibleToAttribute to allow the mock to override the member(s).]]></message>
              <stack-trace><![CDATA[   at Rocks.Rock.Create[T](RockOptions options) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Rock.cs:line 40
   at Rocks.Rock.Create[T]() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Rock.cs:line 18
   at Rocks.Tests.NonPublicTests.GenerateWhenPublicAndNonPublicMembersExist() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\NonPublicTests.cs:line 12]]></stack-trace>
            </failure>
          </test-case>

It's not clear to me why some of these errors are coming up, though the ContextStaticAttribute Obsolete issue is an interesting one that I should probably handle. That is, in Validate(), check to see if the type is marked as Obsolete, and if it has, do not allow the mocking process to continue.

For now, I'll not run this test in .NET Core
<test-case id="1473" name="GenerateForAssemblyThatContainsObject" fullname="Rocks.Tests.RockAssemblyTests.GenerateForAssemblyThatContainsObject" methodname="GenerateForAssemblyThatContainsObject" classname="Rocks.Tests.RockAssemblyTests" runstate="Runnable" seed="1857136235" result="Failed" label="Error" start-time="2017-04-08 03:54:44Z" end-time="2017-04-08 03:54:50Z" duration="5.935912" asserts="0">
            <failure>
              <message><![CDATA[Rocks.Exceptions.CompilationException : Exception of type 'Rocks.Exceptions.CompilationException' was thrown.]]></message>
              <stack-trace><![CDATA[   at Rocks.Construction.Compiler`1.Compile() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\Construction\Compiler.cs:line 136
   at Rocks.RockAssembly.Generate() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockAssembly.cs:line 65
   at Rocks.RockAssembly..ctor(Assembly assembly, RockOptions options) in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Shared\RockAssembly.cs:line 31
   at Rocks.Tests.RockAssemblyTests.GenerateForAssemblyThatContainsObject() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\RockAssemblyTests.cs:line 80]]></stack-trace>
            </failure>
          </test-case>
		  
    [0]: C:\Users\jasonb\.nuget\packages\nunit\3.6.1\lib\netstandard1.6\System\RockContextStaticAttribute.cs(16,54): error CS0619: 'ContextStaticAttribute' is obsolete: 'ContextStaticAttribute is not supported in this release. It has been left in so that legacy tools can be used with this release, but it cannot be used in your code.'
    [1]: C:\Users\jasonb\.nuget\packages\nunit\3.6.1\lib\netstandard1.6\System\Text\RockUTF8Encoding.cs(594,33): error CS0115: 'RockUTF8Encoding.IsAlwaysNormalized(NormalizationForm)': no suitable method found to override
    [2]: C:\Users\jasonb\.nuget\packages\nunit\3.6.1\lib\netstandard1.6\System\Text\RockEncoding.cs(447,33): error CS0115: 'RockEncoding.IsAlwaysNormalized(NormalizationForm)': no suitable method found to override
    [3]: C:\Users\jasonb\.nuget\packages\nunit\3.6.1\lib\netstandard1.6\System\Text\RockUTF7Encoding.cs(589,33): error CS0115: 'RockUTF7Encoding.IsAlwaysNormalized(NormalizationForm)': no suitable method found to override
    [4]: C:\Users\jasonb\.nuget\packages\nunit\3.6.1\lib\netstandard1.6\System\Text\RockUnicodeEncoding.cs(594,33): error CS0115: 'RockUnicodeEncoding.IsAlwaysNormalized(NormalizationForm)': no suitable method found to override
    [5]: C:\Users\jasonb\.nuget\packages\nunit\3.6.1\lib\netstandard1.6\System\Text\RockASCIIEncoding.cs(543,33): error CS0115: 'RockASCIIEncoding.IsAlwaysNormalized(NormalizationForm)': no suitable method found to override
		  
		  
              <failure>
                <message><![CDATA[  Expected string length 1093 but was 1142. Strings differ at index 256.
  Expected: "...= System.Threading.Tasks;\r\na\r\n#pragma warning restore CS80..."
  But was:  "...= System.Threading.Tasks;\r\na\r\nusing System.Reflection;\r\n#p..."
  ------------------------------------------------^
]]></message>
                <stack-trace><![CDATA[at Rocks.Tests.Templates.ClassTemplatesTests.GetClassTemplateWhenIsUnsafeIsFalse() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\Templates\ClassTemplatesTests.cs:line 82
]]></stack-trace>
              </failure>

              <failure>
                <message><![CDATA[  Expected string length 1099 but was 1148. Strings differ at index 256.
  Expected: "...= System.Threading.Tasks;\r\na\r\n#pragma warning restore CS80..."
  But was:  "...= System.Threading.Tasks;\r\na\r\nusing System.Reflection;\r\n#p..."
  ------------------------------------------------^
]]></message>
                <stack-trace><![CDATA[at Rocks.Tests.Templates.ClassTemplatesTests.GetClassTemplateWhenIsUnsafeIsTrue() in M:\JasonBock\Personal\Code Projects\Rocks\Rocks.Tests.Shared\Templates\ClassTemplatesTests.cs:line 23
]]></stack-trace>
              </failure>


Let's approach this a bit differently....use one project with multitarget: http://dontcodetired.com/blog/post/Multiple-Platform-Targeting-in-Visual-Studio-2017

* Create a Rocks.sln
* Create a Rocks.csproj file as a .NET Core class library
* Copy all of the code from Rocks.Shared here. Also make sure to update the csproj file with any changes I needed to do to make the Compiler API stuff work
* Add "net461" to the targets.
* Build and make sure it works.
* Create a Rocks.Tests project to reference this one. This may be tricky at NUnit didn't support the "new" .NET Core project, so this may only be "net461" for now.
* Copy all of the code from Rocks.Tests.Shared here. Also make sure to update the csproj file with any changes I needed to do to make the Compiler API stuff work
* Run tests.
* If I can't get .NET Core tests to run, create another Rocks.Tests.NETCoreTarget project (the name has to be this way to not collide with one that's there) and use NUnitLite
* If all of this works, then commit it, and then remove the shared and reference projects.
